
  <div style="width:100%;height: 1000px" >
    <div class="container-fluid">
      <div class="row">
        <!-- <div class="col-md-12" style="height: 110px;border-bottom-style: solid">

          <button type="button" class="btn btn-primary" (click)="addrow()">add row</button>
          <button type="button" class="btn btn-warning" (click)="save()">Warning</button>

        </div> -->
        <div class="col-md-12 d-flex" style="height: 110px;border-bottom-style: solid;">
          <div class="navitem" (click)="addrow()">
              <img src="../../../assets/icons/New .png" class="img-fluid   " alt="Responsive image">
              <p class="navtext">New</p>
          </div>
          <div class="navitem " (click)="save()" >
              <img src="../../../assets/icons/save.png" style="width: 37px;" class="img-fluid  navimg" alt="Responsive image">
              <p class="navtext">Save</p>
          </div>
          <div class="navitem " >
              <img src="../../../assets/icons/email.png" style="width: 37px;" class="img-fluid  navimg" alt="Responsive image">
              <p class="navtext">Email</p>
          </div>
          <div class="navitem  ">
              <img src="../../../assets/icons/delete.png" (click)="viewfunction(new)" class="img-fluid   navimg" alt="Responsive image">
              <p class="navtext">Delete</p>
          </div>
          <!-- <div class="navitem  ">
              <img src="../../../assets/icons/password.png" class="img-fluid   navimg" alt="Responsive image">
              <p class="navtext">password change</p>
          </div> -->
          <div class="navitem  ">
              <img src="../../../assets/icons/attach.png" style="width: 37px;" class="img-fluid   navimg" alt="Responsive image">
              <p class="navtext">Attach</p>
          </div>
          <div class="navitem  ">
              <img src="../../../assets/icons/Excel.png " class="navimg img-fluid  " alt="Responsive image">
              <p class="navtext">Excel</p>
          </div>
          
          <div class="ml-auto mt-5" >

        <app-logout></app-logout>

       </div>
      </div>
      </div> 
    </div>  

    <div class="container-fluid">       // second big part
        <div class="row">
          <div class="col-md-12" style="height: 1000px;">
            <div style="overflow-x: scroll;">
            <table class="table table-bordered table-hover text-center">

                <!-- <thead> -->
                 <tr>
                    <th  (blur)="edit_mantopic(id, $event)" contenteditable="true" *ngFor="let a of maintopic;let id=index" class="text-center" [style.border]="a.border"  [style.backgroundColor]="a.color" >
                      <span  >{{a.topic}}</span> 
                      
                      
                    </th>
                 </tr>

                  <tr>
                        <th  (blur)="edit_mantopic_name(id, $event)"  contenteditable="true" *ngFor="let a of maintopic; let id=index" class="text-center" > 
                           <span   >{{a.name}}</span>
                          </th>
                  </tr>
                <!-- </thead> -->
                <tbody>

                        <tr   *ngFor="let onecontent of maincontent; let rid = index">
                                <td  *ngFor="let valueobject of onecontent; let cid = index" [style.backgroundColor]="valueobject.color" [contextMenu]="basicMenu" [contextMenuSubject]="{cid:cid,rid:rid,v:c}"  (mouseover)='over(cid,rid,c,$event,com)'>
                                  <span  (blur)="changeValue(rid,cid, $event)" contenteditable="true">{{valueobject.value}}</span>
                                </td>
                            </tr>

                </tbody>
              </table>
            </div>
          </div>
        </div> 
      </div>
  </div>

  
  <context-menu>
        <ng-template contextMenuItem (execute)="addcolumn( $event)">
          <div 
            style="border-bottom-style:solid;border-color: black;" 
           > 
         <a href="" style="color:white;">
          <span style="color: black;">insert column</span>
        </a>
        </div>
        </ng-template>
      
        <ng-template contextMenuItem (execute)="addcomment( $event)"  >
          <div style="border-bottom-style:solid;border-color: black;"> 
            <a href="" style="color:white;">
             <span style="color: black;">insert column</span>
           </a>
           </div>
         </ng-template>
      
         <ng-template contextMenuItem (execute)="showMessage( $event)" >
          
          <div style="border-bottom-style:solid;border-color: black;"> 
            <a href="" style="color:white;">
             <span style="color: black;">Delete comment</span>
           </a>
           </div>

         </ng-template>
         
      
         <ng-template contextMenuItem (execute)="showMessage( $event)" [subMenu]="subMenuMove" >
          
          <div style="border-bottom-style:solid;border-color: black;"> 
            <a href="" style="color:white;">
             <span style="color: black;">change Colur </span>
           </a>
           </div>

         </ng-template>
        
    
    
         <!-- start submenu -->
         <context-menu #subMenuMove>
          <ng-template contextMenuItem>
             
            <button type="button" class="btn btn-primary m-2" (click)="changeColur($event)">Primary</button>
            <button type="button" class="btn btn-secondary m-2">Secondary</button>
            <button type="button" class="btn btn-success m-2">Success</button>
            <button type="button" class="btn btn-danger m-2">Danger</button>
          </ng-template>
          <ng-template contextMenuItem>
            Left
          </ng-template>
        </context-menu>
        <!-- end of sub menu -->
      
    
    
        <ng-template contextMenuItem let-item  >
          
          <div style="border-bottom-style:solid;border-color: rgba(185, 181, 181, 0.281);"> 
            <a href="" style="color:white;">
             <span style="color: black;">Bye </span>
           </a>
           </div>

        </ng-template>
        <!-- <ng-template contextMenuItem divider="true"></ng-template>
      
        <ng-template contextMenuItem passive="true">
          Input something: <input type="text">
        </ng-template> -->
      </context-menu>
    
    
    
      <div id="overlay" #com contenteditable="true">{{commentText}}</div>
     
      <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
        Launch demo modal
      </button> -->