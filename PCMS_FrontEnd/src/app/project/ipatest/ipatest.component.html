
  <div style="width:100%" >
    <div class="container-fluid main_nav" >
      <div class="row">
        <!-- <div class="col-md-12" style="height: 110px;border-bottom-style: solid">

          <button type="button" class="btn btn-primary" (click)="addrow()">add row</button>
          <button type="button" class="btn btn-warning" (click)="save()">Warning</button>

        </div> -->
        <div class="col-md-12 d-flex" style="height: 110px;border-bottom-style: solid;">
          <div *ngIf="projectTableNew" class="navitem" (click)="addrow()">
              <img src="../../../assets/icons/New .png" class="img-fluid   " alt="Responsive image">
              <p class="navtext">New</p>
          </div>
          <div *ngIf="projectSave" class="navitem " (click)="save()" >
              <img src="../../../assets/icons/save.png" style="width: 37px;" class="img-fluid  navimg" alt="Responsive image">
              <p class="navtext">Save</p>
          </div>
          <div *ngIf="projectEmail" class="navitem " >
              <img src="../../../assets/icons/email.png" style="width: 37px;" class="img-fluid  navimg" alt="Responsive image">
              <p class="navtext">Email</p>
          </div>
        <!-- *ngIf="projectExcel" -->
          <div *ngIf="projectExcel" class="navitem" (click)="convertToExcel(epltable)">
              <img src="../../../assets/icons/Excel.png " class="navimg img-fluid  " alt="Responsive image">
              <p class="navtext">Excel</p>
          </div>
          

          
          <div class="ml-auto mt-5" >

            <!-- app log out button is here -->
        <!-- <app-logout></app-logout>    -->
            <!-- app log out buttton end here -->
       </div>
      </div>
      </div> 
    </div> 
    <!-- form head details -->
  <form [formGroup]="projectDetails">
    <div class="container-fluid" >
        <div class="row">
            <div class="col-md-6">
              <div class="form-group row mt-2">
                   <label for="colFormLabelSm1" class="col-sm-4 col-form-label col-form-label-sm">CONTRACT NAME </label>
                  <div class="col-sm-8">
                    <input formControlName="contractName" type="text" class="form-control form-control-sm" id="colFormLabelSm1"  >
                  </div>
              </div>
              <div class="form-group row mt-2">
                <label for="colFormLabelSm2" class="col-sm-4 col-form-label col-form-label-sm">CONTRACT NUMBER  </label>
               <div class="col-sm-8">
                 <input formControlName="contractNumber" type="text" class="form-control form-control-sm" id="colFormLabelSm2"  >
               </div>
              </div>   
              <div class="form-group row mt-2">
                <label for="colFormLabelSm3" class="col-sm-4 col-form-label col-form-label-sm"> START DATE </label>
               <div class="col-sm-8">
                 <input formControlName="startDate" type="text" class="form-control form-control-sm" id="colFormLabelSm3"  >
               </div>
              </div>     
              <div class="form-group row mt-2">
                <label for="colFormLabelSm4" class="col-sm-4 col-form-label col-form-label-sm"> FINISH DATE </label>
               <div class="col-sm-8">
                 <input formControlName="finishDate" type="text" class="form-control form-control-sm" id="colFormLabelSm4" >
               </div>
              </div>  
                 
            </div>

            <div class="col-md-6">
              <div class="form-group row mt-2">
                   <label  for="colFormLabelSm5" class="col-sm-4 col-form-label col-form-label-sm">CONTRACT AMOUNT(earth work) </label>
                  <div class="col-sm-8">
                    <input formControlName="contractAmount" type="text" class="form-control form-control-sm" id="colFormLabelSm5"  >
                  </div>
              </div>
              <div class="form-group row mt-2">
                <label for="colFormLabelSm6" class="col-sm-4 col-form-label col-form-label-sm"> MAXIMUM RETENTION(earth work) </label>
               <div class="col-sm-8">
                 <input formControlName="maximumRetention" type="text" class="form-control form-control-sm" id="colFormLabelSm6"  >
               </div>
              </div>   
              <div class="form-group row mt-2">
                <label for="colFormLabelSm7" class="col-sm-4 col-form-label col-form-label-sm">Adnavance</label>
               <div class="col-sm-8">
                 <input formControlName="advance" type="text" class="form-control form-control-sm" id="colFormLabelSm7"  >
               </div>
              </div>     
              <div class="form-group row mt-2">
                <label for="colFormLabelSm8" class="col-sm-4 col-form-label col-form-label-sm"> Payment status </label>
               <div class="col-sm-8">
                 <input formControlName="paymentStatus" type="text" class="form-control form-control-sm" id="colFormLabelSm8" >
               </div>
              </div>  
                 
            </div>

        </div>
    </div>
  </form>
 <!-- form head details end here -->
    {{a}}
    <!-- changeValue -->
    <div class="container-fluid" style="margin-top: 20px;">        
        <div class="row">
          <div class="col-md-12" style="height: 1000px;">
            <div style="overflow-x: scroll;">
                <!-- text are for comment box -->
              <textarea  (keydown.enter)="MyFunc(comm)"  #comm class="form-control commentbox" id="examp" rows="3"></textarea>

            <table class="table table-bordered table-hover text-center"  #epltable >
              <thead class="thead-dark">
                <!-- <thead> -->
                 <tr>
                    <th contenteditable="false" *ngFor="let t of maintopic;let cid=index"  (blur)="changetopic(cid,$event)"  contenteditable="true"  [attr.colspan]="t.colspan" class="text-center" [style.display]="t.hide" >
                      <span #span>{{t.topic}}</span> 
                    </th>
                 </tr>
                 <tr>
                    <th contenteditable="false" *ngFor="let t of subtopic"   [attr.colspan]="t.colspan" class="text-center" [style.display]="t.hide">
                      <span  >{{t.topic}}</span> 
                    </th>
                 </tr>
                </thead>
                <!-- row_click -->

                  <!-- <tr>
                        <th  (blur)="edit_mantopic_name(id, $event)"  contenteditable="true" *ngFor="let a of basecontent; let id=index" class="text-center" > 
                           <span   >{{a.name}}</span>
                          </th>
                  </tr> -->
                <!-- </thead> -->
                <tbody>

                        <tr   *ngFor="let onearray of basecontent; let rid = index" >
                                <td  *ngFor="let onecontent of onearray; let cid = index" [contextMenu]="basicMenu" [contextMenuSubject]="{content:onecontent,rid:rid,cid:cid}"    [style.backgroundColor]="onecontent.color" [style.display]="onecontent.hide" (mouseover)="trowover(onecontent,$event,comm)" (click)="row_click(rid,cid,comm)" >
                                  <span #span  (blur)="changeValue(rid,cid, $event,span)" contenteditable="true"  [style.backgroundColor]="onecontent.comment!=''? 'red':'' ">{{onecontent.value}}</span>
                                </td>
                        </tr>
                        
                        <tr>
                          <td *ngFor="let t_one of total" [style.display]="t_one.hide">
                            <span #span2       contenteditable="true" >{{t_one.value}}</span>
                          </td>
                        </tr>   
                        
                </tbody>
              </table>
            </div>
          </div>
        </div> 
      </div>
  </div>


                      <!-- modal for document attach -->

  <!-- Button trigger modal -->
<button #attach type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="display: none;">
  Launch demo modal
</button>

<!--fila attach Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="">
          <div class="contaner-fluid">
              <div class="row">
                <div class="col-md-2"></div>
                  <div class="col-md-2">
                    <label class="radio-inline"><input type="radio" name="optradio" (click)="get_ipc_or_ipa(21)" checked>IPA</label>
                  </div>
                  <div class="col-md-4"></div>
                  <div class="col-md-2">
                    <label class="radio-inline"><input type="radio" name="optradio" (click)="get_ipc_or_ipa(22)">IPC</label>
                  </div>
                  <div class="col-md-2"></div>
              </div>
              <div class="row mt-3">
                  <div class="col-md-2"></div>
                  <div class="col-md-10">
                    <input type="file" class="form-control-file" (change)="upload($event,clo)" accept=".png,.jpg,.pdf" id="exampleFormControlFile1">
                  </div>
              </div>
              <div class="row mt-3 ml-3">
                <div class="progress" style="width: 90%;">
                  <div #pro class="progress-bar progress-bar-striped bg-success" role="progressbar" [style.width]="(uploadProgress | async) + '%'" [attr.aria-valuenow]="(uploadProgress | async)" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
              </div>

          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button #clo type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

   

  <context-menu>
    <ng-template contextMenuItem (execute)="addcomment( $event,comm)">
      <div 
        style="border-bottom-style:solid;border-color: black;" 
       > 
     <a href="" style="color:white;">
      <span style="color: black;">add Comment</span>
    </a>
    </div>
    </ng-template>
  
    <ng-template contextMenuItem (execute)="deletecomment( $event)"  >
      <div style="border-bottom-style:solid;border-color: black;"> 
        <a href="" style="color:white;">
         <span style="color: black;">Delete Comment</span>
       </a>
       </div>
     </ng-template>
  
     <ng-template contextMenuItem (execute)="showMessage( $event)" >
      
      <div style="border-bottom-style:solid;border-color: black;"> 
        <a href="" style="color:white;">
         <span style="color: black;">change colour</span>
       </a>
       </div>

     </ng-template>
     
     <ng-template contextMenuItem (execute)="attach_ipaipc($event,attach,pro)" >
      
      <div style="border-bottom-style:solid;border-color: black;"> 
        <a href="" style="color:white;">
         <span style="color: black;">attach ipa/ipc</span>
       </a>
       </div>

     </ng-template>

     <ng-template contextMenuItem (execute)="delete_row( $event)"   >
      
      <div style="border-bottom-style:solid;border-color: black;"> 
        <a href="" style="color:white;">
         <span style="color: black;">Delete Row</span>
       </a>
       </div>

     </ng-template>

     <ng-template contextMenuItem (execute)="delete_row( $event)" [subMenu]="subMenuMove" >
      
      <div style="border-bottom-style:solid;border-color: black;"> 
        <a href="" style="color:white;">
         <span style="color: black;">Delete attach</span>
       </a>
       </div>

     </ng-template>


     <!-- start submenu for removing document-->
     <context-menu #subMenuMove>
      <ng-template contextMenuItem (execute)="Delete_Ipa($event)" >
      
        <div style="border-bottom-style:solid;border-color: black;"> 
          <a href="" style="color:white;">
           <span style="color: black;">Delete Ipa</span>
         </a>
         </div>
  
      </ng-template>
      <ng-template contextMenuItem (execute)="Delete_Ipc($event)" >
      
        <div style="border-bottom-style:solid;border-color: black;"> 
          <a href="" style="color:white;">
           <span style="color: black;">Delete ipc</span>
         </a>
         </div>
  
      </ng-template>
      <ng-template contextMenuItem (execute)="Delete_check($event)" >
      
        <div style="border-bottom-style:solid;border-color: black;"> 
          <a href="" style="color:white;">
           <span style="color: black;">Delete check</span>
         </a>
         </div>
  
      </ng-template>
    </context-menu>
    <!-- end of sub menu -->
  


    <ng-template contextMenuItem let-item  (execute)="hide_column( $event)" >
      
      <div style="border-bottom-style:solid;border-color: rgba(185, 181, 181, 0.281);"> 
        <a href="" style="color:white;">
         <span style="color: black;">Hide Column </span>
       </a>
       </div>

    </ng-template>
    <!-- <ng-template contextMenuItem divider="true"></ng-template>
  
    <ng-template contextMenuItem passive="true">
      Input something: <input type="text">
    </ng-template> -->
  </context-menu>


 